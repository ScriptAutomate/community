# Notes from 2020-08-18

## Attendees
- Chad McMarrow
- Joe Eacott
- Markus Kramer
- Shane Lee
- dafyddj

## Protocol
- Profiling
  - We set up a Salt dev environment (pip -e .)
    - We discussed the instructions on https://github.com/markuskramerIgitt/LearnSalt/tree/master/cProfile_performance_profiler
  - We profiled the 3000.2 minion with file.replace and discussed known and unknown wastes of time:
    - We installed snakeviz ("snake vizualizer"):
      - Snakeviz has an upper, image section that you can drill down and drill out (Reset Zoom)
      - Snakeviz has an lower, table section that you can sort
      - Snakeviz uses time units "s" which are longer than real-life seconds, but we call them seconds for the sake of brevity. 
    - From the image section:
      - The whole `file.replace` takes 12 seconds
      - `loader.py` takes 8 / 12 seconds and load all modules, which individually detect the platform. Because the platform is known, the individual detection is an unnecessary       - `esxi.py` takes 7 / 12 seconds and is not needed on Windows and is no longer loaded on Windows in [3001.1](https://github.com/saltstack/salt/pull/57743).
compation.  Avoiding these unnecessary compations could speed up the loader. 
    - from the table section, sorted by `cumtime`: 
      - `frozen importlib._bootstrap` is called ~5,000 times and takes 10 / 12 seconds. This probably leads back to the loader.  
   - We discussed that snakeziz delivers a useful overview but we lack experience to read the result. 

